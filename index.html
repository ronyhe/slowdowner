<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lame Slowdowner</title>
</head>
<body>
<input type="file" id="file-input" onchange="onChangeFile()" accept="audio/*">
<label for="speed">Speed: </label><input value="1.0" step="0.1" min="0.1" max="1.0" type="number" id="speed" onchange="onChangeSpeed()"/>
<br />
<audio id="audio" controls ondurationchange="onDurationChange()"></audio>
<br />
<label for="start-minutes">Start: </label><input type="number" value=0 step="1" min="0" max="3" id="start-minutes">
<label for="start-seconds"></label><input type="number" value="0" step="1" min="0" max="59" id="start-seconds">
<br />
<label for="end-minutes">End  : </label><input type="number" value=3 step="1" min="0" max="3" id="end-minutes">
<label for="end-seconds"></label><input type="number" value=59 step="1" min="0" max="59" id="end-seconds">
<script>
    function audio() {
        return document.getElementById('audio')
    }
    function onChangeFile() {
        audio().src = URL.createObjectURL(document.getElementById('file-input').files[0])
    }
    function onChangeSpeed() {
        audio().playbackRate = document.getElementById('speed').value
    }
    function onDurationChange() {
        const duration = audio().duration
        const minutes = Math.floor(duration / 60)
        const seconds = Math.floor(duration % 60) + 1
        const timeInputs = ['start-minutes', 'start-seconds', 'end-minutes', 'end-seconds']
        timeInputs.forEach(name => {
            document.getElementById(name).value = 0
        })
        document.getElementById('end-minutes').max = minutes
        document.getElementById('end-minutes').value = minutes
        document.getElementById('end-seconds').value = seconds
    }
</script>
</body>
</html>
